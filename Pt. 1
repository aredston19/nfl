import pandas as pd
import numpy as np
def func(team, year):
    ##turn the csv data into a dataframe
    df = pd.read_csv("NFL_data.csv") 
    
    df["Win Count"] = np.where(df["Team Score"] > df["Opponent Score"],1, 0)
    df["Loss Count"] = np.where(df["Team Score"] < df["Opponent Score"],1, 0)
    df["Ties"] = np.where(df["Team Score"] == df["Opponent Score"],1, 0)
    
    ##can you filter on two criteria in the same line?
    ##Has to be yes, but this was giving me some trouble so I broke it out into two lines
    
    df_0 = df.loc[df["Team ID"] == team]
    df_1 = df_0.loc[df_0["Schedule Season"] == year]
    df_playoffcheck = df_1.loc[df_1["Schedule Playoff"] == True]

    ##This is unecessarily messy, because of all the text included in the output
    if sum(df_1["Ties"]) > 0 & len(df_playoffcheck) > 0:
        print("In " + str(year) + " " + str(team) + " went " + str(sum(df_1[("Win Count")])) + "-" 
        + str(sum(df_1[("Loss Count")])) + "-" + str(sum(df_1[("Ties")])) + "; scored "
        + str(sum(df_1[("Team Score")])) + " points and " + str(team) + " made the playoffs.")
    
    elif sum(df_1["Ties"]) > 0 & len(df_playoffcheck) == 0:
        print("In " + str(year) + " " + str(team) + " went " + str(sum(df_1[("Win Count")])) + "-" 
        + str(sum(df_1[("Loss Count")])) + "-" + str(sum(df_1[("Ties")])) + "; scored "
        + str(sum(df_1[("Team Score")])) + " points and " + str(team) + " didn't make the playoffs.")
    
    elif len(df_playoffcheck) > 0:
        print("In " + str(year) + " " + str(team) + " went " + str(sum(df_1[("Win Count")])) + "-" 
        + str(sum(df_1[("Loss Count")])) + "; scored "
        + str(sum(df_1[("Team Score")])) + " points and " + str(team) + " made the playoffs.")
    
    else:
        print("In " + str(year) + " " + str(team) + " went " + str(sum(df_1[("Win Count")])) + "-" 
        + str(sum(df_1[("Loss Count")])) + "; scored "
        + str(sum(df_1[("Team Score")])) + " points and " + str(team) + " didn't make the playoffs.")   
    
## function to itterate the above function for every year combination
def func2():

    df = pd.read_csv("NFL_data.csv") ##turn the csv data into a dataframe
    IDs = df["Team ID"].tolist()
    ID_unique = []
    for i in (IDs):
        if i not in ID_unique:
            ID_unique.append(i)
            ID_sorted = sorted(ID_unique)
    
    print(ID_sorted)

    years = df["Schedule Season"].tolist()
    year_unique = []
    for j in (years):
        if j not in year_unique:
            year_unique.append(j)
            year_sorted = sorted(year_unique)
            
    for k in(ID_sorted):
        for l in(year_sorted):
            func(k,l)

func2()
