import pandas as pd
import numpy as np
def func3(year):
    df = pd.read_csv("NFL_data.csv") 
    ##turn the csv data into a dataframe

    
    ##to retrieve each team-year combination
    teamseason = df["Team_Season"].tolist() 
    ts_unique = []
    for i in teamseason:
        if i not in ts_unique:
            ts_unique.append(i)

    ##print(len(ts_unique))


    playoffcheck = df.loc[df["Schedule Playoff"] == True] 

    ## to retreive the team-year combinations for playoff teams
    playoff_teams = playoffcheck["Team_Season"].tolist()
    pt_unique = []  
    for j in playoff_teams:
        if j not in pt_unique:
            pt_unique.append(j)  

    pt_sorted = sorted(pt_unique)
    ##print(len(pt_sorted))

    
    ##and now the non-playoff teams
    non_playoff = []
    for k in ts_unique:
        if k not in pt_sorted:
            non_playoff.append(k)
    
    np_sorted = sorted(non_playoff)
    ##print(len(np_sorted))

    ##data fram filtered on non-playoff teams
    df_n = df.loc[df["Team_Season"].isin(np_sorted)]

    ##filtered again for the desired year
    df_np = df_n.loc[df_n["Schedule Season"] == year]

    ##print(df_np)

    ##to retrieve every team abreviation
    IDs = df_np["Team ID"].tolist() 
    ID_unique = []
    for i in (IDs):
        if i not in ID_unique:
            ID_unique.append(i)
            ID_sorted = sorted(ID_unique)

    ## team name and total points in a year for each team
    t = []
    p = []
    for j in ID_sorted:
        t.append(j)
        test = df_np.loc[df_np["Team ID"] == j]
        p.append(sum(test["Team Score"]))

    ## This part seems pretty inefficient, but I couldn't think of a better way
    c = []

    c.append(t)
    c.append(p) 
    
    ##print(c)

    df2 = pd.DataFrame(c).T
    df2.columns = ["Teams", "Points"]

    pmax = max(p)

    ts = df2.loc[df2["Points"] == pmax]
    top_scorer =ts.reset_index(drop=True)

    print("In " + str(year) + " for teams that missed the playoffs " + str(top_scorer.at[0,"Teams"]) 
    + " led the leage in scoring with " + str(top_scorer.at[0,"Points"]) + " points.")


## function to itterate the above function for every year combination
def func4():

    df = pd.read_csv("NFL_data.csv") ##turn the csv data into a dataframe
    
    years = df["Schedule Season"].tolist()
    year_unique = []
    for i in (years):
        if i not in year_unique:
            year_unique.append(i)
            year_sorted = sorted(year_unique)
            
    for j in(year_sorted):
            func3(j)

func4()
